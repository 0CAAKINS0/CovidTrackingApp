@page "/map"
@using CovidApp.Data
@using Microsoft.JSInterop
@inject DataService DataService
@inject IJSRuntime JSRuntime

<h1>Covid Data Map</h1>
@if (isLoaded)
        {
<RadzenGoogleMap style="height:700px;" Zoom="3" Center="@(new GoogleMapPosition() { Lat = 47.116386, Lng = -101.299591 })" MarkerClick=@OnMarkerClick>
    
    <Markers>
        
            <RadzenGoogleMapMarker Title="FL" Label="Florida" Position=@(new GoogleMapPosition() { Lat = 27.994402, Lng = -81.760254 }) />
            <RadzenGoogleMapMarker Title="OK" Label="Oklahoma" Position=@(new GoogleMapPosition() { Lat = 36.084621, Lng = -96.921387 }) />
            <RadzenGoogleMapMarker Title="HI" Label="Hawaii" Position=@(new GoogleMapPosition() { Lat = 19.741755, Lng = -155.844437 }) />
            <RadzenGoogleMapMarker Title="WI" Label="Wisconsin" Position=@(new GoogleMapPosition() { Lat = 44.500000, Lng = -89.500000 }) />
            <RadzenGoogleMapMarker Title="WV" Label="West Virginia" Position=@(new GoogleMapPosition() { Lat = 39.000000, Lng = -80.500000 }) />
            <RadzenGoogleMapMarker Title="VT" Label="Vermont" Position=@(new GoogleMapPosition() { Lat = 44.000000, Lng = -72.699997 }) />
            <RadzenGoogleMapMarker Title="TX" Label="Texas" Position=@(new GoogleMapPosition() { Lat = 31.000000, Lng = -100.000000 }) />
            <RadzenGoogleMapMarker Title="SD" Label="South Dakota" Position=@(new GoogleMapPosition() { Lat = 44.500000, Lng = -100.000000 }) />
            <RadzenGoogleMapMarker Title="RI" Label="Rhode Island" Position=@(new GoogleMapPosition() { Lat = 41.742325, Lng = -71.742332 }) />
            <RadzenGoogleMapMarker Title="OR" Label="Oregon" Position=@(new GoogleMapPosition() { Lat = 44.000000, Lng = -120.500000 }) />
            <RadzenGoogleMapMarker Title="NY" Label="New York" Position=@(new GoogleMapPosition() { Lat = 43.000000, Lng = -75.000000 }) />
            <RadzenGoogleMapMarker Title="NH" Label="New Hampshire" Position=@(new GoogleMapPosition() { Lat = 44.000000, Lng = -71.500000 }) />
            <RadzenGoogleMapMarker Title="NE" Label="Nebraska" Position=@(new GoogleMapPosition() { Lat = 41.500000, Lng = -100.000000 }) />
            <RadzenGoogleMapMarker Title="KS" Label="Kansas" Position=@(new GoogleMapPosition() { Lat = 38.500000, Lng = -98.000000 }) />
            <RadzenGoogleMapMarker Title="MS" Label="Mississippi" Position=@(new GoogleMapPosition() { Lat = 33.000000, Lng = -90.000000 }) />
            <RadzenGoogleMapMarker Title="IL" Label="Illinois" Position=@(new GoogleMapPosition() { Lat = 40.000000, Lng = -89.000000 }) />
            <RadzenGoogleMapMarker Title="DE" Label="Delaware" Position=@(new GoogleMapPosition() { Lat = 39.000000, Lng = -75.500000 }) />
            <RadzenGoogleMapMarker Title="CT" Label="Connecticut" Position=@(new GoogleMapPosition() { Lat = 41.599998, Lng = -72.699997 }) />
            <RadzenGoogleMapMarker Title="AK" Label="Arkansas" Position=@(new GoogleMapPosition() { Lat = 34.799999, Lng = -92.199997 }) />
            <RadzenGoogleMapMarker Title="IN" Label="Indiana" Position=@(new GoogleMapPosition() { Lat = 40.273502, Lng = -86.126976 }) />
            <RadzenGoogleMapMarker Title="MO" Label="Missouri" Position=@(new GoogleMapPosition() { Lat = 38.573936, Lng = -92.603760 }) />
            <RadzenGoogleMapMarker Title="NV" Label="Nevada" Position=@(new GoogleMapPosition() { Lat = 39.876019, Lng = -117.224121 }) />
            <RadzenGoogleMapMarker Title="ME" Label="Maine" Position=@(new GoogleMapPosition() { Lat = 45.367584, Lng = -68.972168 }) />
            <RadzenGoogleMapMarker Title="MI" Label="Michigan" Position=@(new GoogleMapPosition() { Lat = 44.182205, Lng = -84.506836 }) />
            <RadzenGoogleMapMarker Title="GA" Label="Georgia" Position=@(new GoogleMapPosition() { Lat = 33.247875, Lng = -83.441162 }) />
            <RadzenGoogleMapMarker Title="AK" Label="Alaska" Position=@(new GoogleMapPosition() { Lat = 66.160507, Lng = -153.369141 }) />
            <RadzenGoogleMapMarker Title="TN" Label="Tennessee" Position=@(new GoogleMapPosition() { Lat = 35.860119, Lng = -86.660156 }) />
            <RadzenGoogleMapMarker Title="VA" Label="Virginia" Position=@(new GoogleMapPosition() { Lat = 37.926868, Lng = -78.024902 }) />
            <RadzenGoogleMapMarker Title="NJ" Label="New Jersey" Position=@(new GoogleMapPosition() { Lat = 39.833851, Lng = -74.871826 }) />
            <RadzenGoogleMapMarker Title="KY" Label="Kentucky" Position=@(new GoogleMapPosition() { Lat = 37.839333, Lng = -84.270020 }) />
            <RadzenGoogleMapMarker Title="ND" Label="North Dakota" Position=@(new GoogleMapPosition() { Lat = 47.650589, Lng = -100.437012 }) />
            <RadzenGoogleMapMarker Title="MN" Label="Minnesota" Position=@(new GoogleMapPosition() { Lat = 46.392410, Lng = -94.636230 }) />
            <RadzenGoogleMapMarker Title="MT" Label="Montana" Position=@(new GoogleMapPosition() { Lat = 46.965260, Lng = -109.533691 }) />
            <RadzenGoogleMapMarker Title="WA" Label="Washington" Position=@(new GoogleMapPosition() { Lat = 47.751076, Lng = -120.740135 }) />
            <RadzenGoogleMapMarker Title="UT" Label="Utah" Position=@(new GoogleMapPosition() { Lat = 39.419220, Lng = -111.950684 }) />
            <RadzenGoogleMapMarker Title="CO" Label="Colorado" Position=@(new GoogleMapPosition() { Lat = 39.113014, Lng = -105.358887 }) />
            <RadzenGoogleMapMarker Title="OH" Label="Ohio" Position=@(new GoogleMapPosition() { Lat = 40.367474, Lng = -82.996216 }) />
            <RadzenGoogleMapMarker Title="AL" Label="Alabama" Position=@(new GoogleMapPosition() { Lat = 32.318230, Lng = -86.902298 }) />
            <RadzenGoogleMapMarker Title="IA" Label="Iowa" Position=@(new GoogleMapPosition() { Lat = 42.032974, Lng = -93.581543 }) />
            <RadzenGoogleMapMarker Title="NM" Label="New Mexico" Position=@(new GoogleMapPosition() { Lat = 34.307144, Lng = -106.018066 }) />
            <RadzenGoogleMapMarker Title="SC" Label="South Carolina" Position=@(new GoogleMapPosition() { Lat = 33.836082, Lng = -81.163727 }) />
            <RadzenGoogleMapMarker Title="PA" Label="Pennsylvania" Position=@(new GoogleMapPosition() { Lat = 41.203323, Lng = -77.194527 }) />
            <RadzenGoogleMapMarker Title="AZ" Label="Hawaii" Position=@(new GoogleMapPosition() { Lat = 34.048927, Lng = -111.093735 }) />
            <RadzenGoogleMapMarker Title="MD" Label="Maryland" Position=@(new GoogleMapPosition() { Lat = 39.045753, Lng = -76.641273 }) />
            <RadzenGoogleMapMarker Title="MA" Label="Massachusetts" Position=@(new GoogleMapPosition() { Lat = 42.407211, Lng = -71.382439 }) />
            <RadzenGoogleMapMarker Title="CA" Label="California" Position=@(new GoogleMapPosition() { Lat = 36.778259, Lng = -119.417931 }) />
            <RadzenGoogleMapMarker Title="ID" Label="Idaho" Position=@(new GoogleMapPosition() { Lat = 44.068203, Lng = -114.742043 }) />
            <RadzenGoogleMapMarker Title="WY" Label="Wyoming" Position=@(new GoogleMapPosition() { Lat = 43.075970, Lng = -107.290283 }) />
            <RadzenGoogleMapMarker Title="NC" Label="North Carolina" Position=@(new GoogleMapPosition() { Lat = 35.782169, Lng = -80.793457 }) />
            <RadzenGoogleMapMarker Title="LA" Label="Louisiana" Position=@(new GoogleMapPosition() { Lat = 30.391830, Lng = -92.329102 }) />
            <RadzenGoogleMapMarker Title="GU" Label="Guam" Position=@(new GoogleMapPosition() { Lat = 13.535304, Lng = 144.885964 }) />
            <RadzenGoogleMapMarker Title="MA" Label="Northern Mariana Islands" Position=@(new GoogleMapPosition() { Lat = 15.183333, Lng = 145.750000 }) />
            <RadzenGoogleMapMarker Title="DC" Label="District of Columbia" Position=@(new GoogleMapPosition() { Lat = 38.889805, Lng = -77.009056 }) />
            <RadzenGoogleMapMarker Title="PR" Label="Puerto Rico" Position=@(new GoogleMapPosition() { Lat = 18.200178, Lng = -66.664513 }) />
            <RadzenGoogleMapMarker Title="VI" Label="Virgin Islands" Position=@(new GoogleMapPosition() { Lat = 18.3434415, Lng = -64.8671634 }) />
            <RadzenGoogleMapMarker Title="AS" Label="American Samoa" Position=@(new GoogleMapPosition() { Lat = -14.275632, Lng = -170.702042 }) />
        
        
    </Markers>
    
</RadzenGoogleMap>
}
else
        {
            <RadzenStack AlignItems="AlignItems.Center" Class="rz-m-12" Gap="2rem">
                <RadzenProgressBarCircular Value="100" ShowValue="false" Mode="ProgressBarMode.Indeterminate" />
            </RadzenStack>
        }
@code {
    IList<CovidData> data = new List<CovidData>();
    bool isLoaded;

    protected override async Task OnInitializedAsync()
    {
        data = await DataService.GetCovidData();
        isLoaded = true;
    }
    async Task OnMarkerClick(RadzenGoogleMapMarker marker)
    {
        CovidData stateData = new CovidData();
        stateData = data.FirstOrDefault(d => d.state == marker.Title);
        var message = $"{marker.Label} Covid Data as of 3/7/2021\nTotal: {stateData.total}\nPositive: {stateData.positive}\nNegative: {stateData.negative}\nHospitalized: {stateData.hospitalized}";

        await JSRuntime.InvokeVoidAsync("alert", message);
    }
}
